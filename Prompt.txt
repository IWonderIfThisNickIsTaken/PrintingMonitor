Software Development Specification: Windows Print Job Monitoring and Analytics System
Objective:
Develop a C++ application for Windows that provides comprehensive print job monitoring, data collection, and reporting capabilities.
Core Requirements:

    Real-time Print Monitoring

        Continuously monitor all active printers on the Windows system

        Capture print jobs from all connected printers (local, network, virtual)

        Maintain active monitoring while the application is running

    Data Collection & Metadata Capture

        Collect the following print job attributes:

            Printer name/identifier

            Timestamp (date and time with timezone)

            Job status (queued, printing, completed, error)

            Number of pages

            Document size (bytes)

            Color mode (monochrome/color)

            Duplex setting

            Paper size/type

            User account/initiator

            Job ID (system-assigned)

    Data Persistence & Export

        Store collected data in CSV format with proper headers

        Implement automatic periodic saving to prevent data loss

        Provide manual export functionality via commands

        Support multiple export destinations and file naming conventions

    Command Interface

        Interactive commands for:

            Start/stop monitoring

            Force data save/export

            View current statistics

            Export to specified file path

            Configuration management

Technical Specifications:

    Platform: Windows (Win32 API preferred)

    Language: C++ (C++17 or later standard)

    Libraries: Use Windows Print Spooler APIs, consider Boost for utilities

    Architecture: Event-driven design for print job notifications

    Data Format: RFC-4180 compliant CSV with timestamp in ISO 8601 format

    Error Handling: Comprehensive error logging and graceful recovery

Additional Requirements:

    Performance: Minimal system impact during monitoring

    Reliability: Handle spooler service restarts and printer additions/removals

    Security: Appropriate permissions for print spooler access

    Scalability: Support for systems with multiple printers and high print volumes

Deliverables:

    Complete C++ source code with build configuration

    Documentation covering:

        Build instructions

        Usage guide for command interface

        Data field specifications

    Example CSV output with sample data

Constraints:

    Must run on Windows 10/11 and Windows Server 2016+

    No external dependencies beyond standard Windows libraries and approved third-party libraries

    Memory-efficient design for long-running operation

Must be compiled with Visual Studio Code using g++ and only one cpp file
Compile and fix any compilation errors.
